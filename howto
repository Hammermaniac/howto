#!/bin/bash

# Declare book name in ${books} array, e.g. books=( "mybook" "git" )
# Then create a file in ~/.common-configs/ using the naming convention: howtos.mybook
#
# So the above should be:
#   ~/.common-configs/howtos.mybook
#   ~/.common-configs/howtos.git

books=( "void" "term" )
n=$#

# Exit if no arguments are supplied, nothing to do.
if [ $# -eq 0 ] ; then 
  echo "No arguments supplied." ; 
else 
  echo '' 
fi

for n do {
  # Escape if we run out of arguments.
  if [ $# -eq 0 ] ; then
    exit 0
  fi
  # If argument is a book title (i.e in ${books} array), use the specified book.
  if [[ "${books[@]}" =~ "$1" ]]
    then
	book="/home/$USER/.common-configs/howto.$1"
  	shift
	if [ $# -eq 0 ] ; then
  	  echo -e "\033[1;32m# No arguments supplied after book.\033[0m Displaying all book contents instead."
	  echo ''
	fi
  else
  	book="/home/$USER/.common-configs/howto.main"
  fi
  # Find supplied argument (keyword) in book and display.
  grep -i "$1" "$book" | while read -r line
  do
	echo -e "\033[36m——————————————————————————————————\033[0m"
	line=$(printf '%b\n' "$( echo -e "$line" | sed ''/": "/s//:`printf "\033[1;36m——————————————————————————————————\033[0m"`/'' | sed 's/——————————————————————————————————/\n——————————————————————————————————\n/' )")
	echo -e "$line\n\n"
  done
  shift
} done

exit 0
